# 物理层  
---  
## 通信基础  
### 基本概念  
#### 数据、信号和码元  
数据是指传送信息的实体。信号是指数据的电气或电磁表现，是数据在传输过程中的存在形式。数据和信号都可用“模拟的”或“数字的”来修饰：
+ 连续变化的数据（或信号）称为模拟数据（模拟信号）  
+ 取指仅允许为有限的几个离散数值的数据（或信号）称为数字数据（或数字信号）  

数据传输方式可分为串行传输和并行传输。串行传输是指一个一个的比特按照时间顺序传输（出于经济上的考虑，远距离通信常采用串行传输），并行传输是指多个比特通过多条通信信道同时传输。  
码元是指用一个固定时长的信号波形（数字脉冲）表示一位k进制数字，代表不同离散数值的基本波形，是数字通信中数字信号的计量单位，这个时长内的信号称为k进制码元，而该时长称为码元宽度。1码元可以携带多个比特的信息量。  
#### 信源、信道和信宿  
数据通信是指数字计算机或其他数字终端之间的通信。一个数据通信系统主要划分为信源、信道和信宿三部分。  
信源是产生和发送数据的源头。信宿是接收数据的终点，它们通常都是计算机或其他数字终端装置。发送端信源发出的信号需要通过变换器转换成适合于信道上传输的信号，而通过信道传输到接收端的信号先由反变换器转换为原始信号，再发送给信宿。  
信道与电路并不等同，信道是信号的传输媒介。一个信道可视为一条线路的逻辑部件，一般用来表示向某个方向传送信息的介质，因此一条通信线路往往包含一条发送信道和一条接收信道，噪声源是信道上的噪声（即对信号的干扰）及分散在通信系统其他各处的噪声的集中表示。  
信道按传输信号形式的不同可分为传送模拟信号的模拟信道和传送数字信号的数字信道两大类；信道按传输介质的不同可分为无线信道和有线信道。  
信道上传送的信号有基带信号和宽带信号之分。基带信号将数字信号1和0直接使用两种不同的电压表示，然后送到数字信道上传输（称为基带传输）；宽带信号即基带信号进行调制后形成频分复用模拟信号，然后传送到模拟信道上去传输（称为宽度传输）。  
从通信双方信息的交互方式看，可分为三种基本方式：  
+ 单工通信。只有一个方向的通信而没有反方向的交互，仅需要一条信道。例如，无线电广播、电视广播就属于这种类型。  
+ 半双工通信。通信的双方都可以发送或接收信息，但任何一方都不能同时发送和接收信息，此时需要两条信道。  
+ 全双工通信。通信双方可以同时发送和接收信息，也需要两条信道。  

信道的极限容量是指信道的最高码元传输速率或信道的极限信息传输速率。  
#### 速率、波特和带宽  
速率也称数据率，指的是数据的传输速度，表示单位时间内传输的数据量。可以用码元传输速率和信息传输速率表示。  
+ 码元传输速率。又称码元速率、波形速率等，它表示单位时间内数字通信系统所传输的码元个数（也可称为脉冲个数或信号变化的次数），单位是波特(Baud)。1波特表示数字通信系统每秒传输一个码元。这里的码元可以是多进制的，也可以是二进制的，但码元速率与进制数无关。  
+ 信息传输速率。又称信息速率、比特率等，它表示单位时间内数字通信系统传输的二进制码元个数（即比特数），单位是比特/秒。  
若一个码元携带n比特的信息量，则M波特率的码元传输速率所对应的信息传输速率为Mn比特/秒。  

带宽原指信号具有的频带宽度，单位是赫兹Hz。在实际网络中，由于数据率是信道最重要的指标之一，而带宽与数据率存在数值上的互换关系，因此常用来表示网络的通信线路所能传输数据的能力。因此，带宽表示单位时间内从网络中的某一点到另一点所能通过的“最高数据率”。此时带宽的单位不再是Hz，而是b/s。  

### 奈奎斯特定理与香农定理  
#### 奈奎斯特定理  
奈奎斯特(Nyquist)定理又称奈氏准则，它指出在理想低通（没有噪声、带宽有限）的信道中，极限码元传输率为`2W`波特，其中`W`是理想低通信道的带宽，单位为Hz。若用`V`表示每个码元离散电平的数目（码元的离散电平的数目是指有多少种不同的码元，比如有16种不同的码元，则需要4位二进制位，因此数据传输率是码元传输率的4倍），则极限数据率为  
**理想低通信道下的极限数据传输率 = 2Wlog<sub>2</sub>V**（单位为b/s）  
对于奈氏准则，可以得出以下结论：  
+ 在任何信道中，码元传输的速率是有上限的。若传输速率超过此上限，就会出现严重的码间串扰问题（指在接收端收到的信号波形失去了码元之间的清晰界限），使得接收端不可能完全正确识别码元。  
+ 信道的频带越宽（即通过的信号高频分量越多），就可用更高的速率进行码元的有效传输。  
+ 奈氏准则给出了码元传输速率的限制，但并未对信息传输速率给出限制，即未对一个码元可以对应多少个二进制位给出限制。  

由于码元的传输速率受奈氏准则的制约，所以要提高数据的传输速率，就必须设法使每个码元携带更多个比特的信息量，此时就需要采用多元制的调制方法。  

#### 香农定理  
香农(Shannon)定理给出了带宽受限且有高斯白噪声干扰的信道的极限数据传输率，当用此速率进行传输时，可以做到不产生误差。香农定理定义为  
**信道的极限数据传输率 = Wlog<sub>2</sub>(1 + S/N)**（单位为b/s）  
式中，`W`为信道的带宽，`S`为信道所传输信号的平均功率，`N`为信道内部的高斯噪声功率。`S/N`为信噪比，即信号的平均功率与噪声的平均功率之比，信噪比=10log<sub>10</sub>(S/N)(单位为dB)，例如当S/N=10时，信噪比为10dB，而当S/N=1000时，信噪比为30dB。  
对应香农定理，可以得出以下结论：  
+ 信道的带宽或信道中的信噪比越大，信息的极限传输率越高。  
+ 对一定的传输带宽和一定的信噪比，信息传输速率的上限是确定的。  
+ 只要信息的传输速率低于信道的极限传输速率，就能找到某种方法来实现无差错的传输。  
+ 香农定理得出的是极限信息传输速率，实际信道能达到的传输速率要比它低不少。  

从香农定理可以看出，若信道带宽W或信噪比S/N没有上限（实际信道不可能实现），则信道的极限信息传输速率也没有上限。  
奈氏准则只考虑了带宽与极限码元传输速率的关系，而香农定理不仅考虑到了带宽，也考虑到了信噪比。这从一个侧面表示，一个码元对应的二进制位数是有限的。  

### 编码与调制  
数据无论是数字的还是模拟的，为了传输的目的都必须转变成信号。把数据变换为模拟信号的过程称为调制，把数据变换为数字信号的过程称为编码。  
信号是数据的具体表现形式，它和数据有一定的关系，但又和数据不同。数字数据可以通过数字发送器转换为数字信号传输，也可以通过调制器转换成模拟信号传输；同样，模拟数据可以通过PCM编码器转换成数字信号传输，也可以通过放大器调制器转换成模拟信号传输。这样，就形成了下列4种编码方式。  
#### 数字数据编码为数字信号  
数字数据编码用于基带传输中，即在基本不改变数字数据信号频率的情况下，直接传输数字信号。具体用什么样的数字信号表示0以及用什么样的数字信号表示1就是所谓的编码。编码的规则有多种，只要能有效地把1和0区分开即可，常用的编码方式有以下几种：  
+ 归零编码  
  在归零编码RZ中用高电平代表1、低电平代表0（或者相反），每个时钟周期的中间均跳变到低电平（归零），接收方根据该跳变调整本方的时钟基准，这就为传输双方提供了自同步机制。由于归零需要占用一部分带宽，因此传输速率收到了一定的影响。  
+ 非归零编码  
  非归零编码NRZ与RZ编码的区别是不用归零，一个周期可以全部用来传输数据。但NRZ编码无法传递时钟信号，双方难以同步，因此若想传输高速同步数据，则需要都带有时钟线。  
+ 反向非归零编码  
  反向非归零编码NRZI与NRZ编码的区别是用信号的翻转代表0、信号保持不变代表1。翻转的信号本身可以作为一种通知机制。这种编码方式集成了前两种编码的优点，既能传输时钟信号，又能尽量不损失系统带宽。USB 2.0通信的编码方式就是NRZI编码。  
+ 曼彻斯特编码  
  曼彻斯特编码Manchester Encoding将一个码元分成两个相等的间隔，前一个间隔为高电平而后一个间隔为低电平表示码元1；码元0的表示方法则正好相反。当然，也可采用相反的规定。该编码的特点是，在每个码元的中间出现电平跳变，位中间的跳变既作为时钟信号（可用于同步），又作为数据信号，但它所占的频带宽度是原始基带宽度的两倍。**以太网使用的编码方式就是曼彻斯特编码。**  
+ 差分曼彻斯特编码  
  差分曼彻斯特编码常用于局域网传输，其规则是，若码元为1,则前半个码元的电平与上一个码元的后半个码元的电平相同；若码元为0,则情形相反。该编码的特点是，在每个码元的中间都有一次电平的翻转，可以实现自同步，且抗干扰性较好。  
+ 4B/5B编码  
  将欲发送数据流每4位作为一组，然后根据4B/5B编码规则将其转换成相应的5位码。5位码共32种组合，但只采用其中的16种对应16种不同的4位码，其他的16种作为控制码（帧的开始和结束、线路的状态信息等）或保留。  

#### 数字信号调制为模拟信号  
数字信号调制技术在发送端将数字信号转换为模拟信号，而在接收端将模拟信号还原为数字信号，分别对应于调制解调器的调制和解调过程。基本的调制方法有如下几种：  
+ 幅移键控ASK。通过改变载波信号的振幅来表示数字信号1和0,而载波的频率和相位都不改变。比较容易实现，但抗干扰能力差。  
+ 频移键控FSK。通过改变载波信号的频率来表示数字信号1和0,而载波的振幅和相位都不改变。容易实现，抗干扰能力强，目前应用较为广泛。  
+ 相移键控PSK。通过改变载波信号的相位来表示数字信号1和0,而载波的振幅和频率都不改变。它又分为绝对调相和相对调相。  
+ 正交振幅调制QAM。在频率相同的前提下，将ASK与PSK结合起来，形成叠加信号。设波特率为B，采用m个相位，每个相位有n种振幅，则该QAM技术的数据传输率R为  
  R = B*log*<sub>2</sub>(mn) (单位为*b/s*)  

#### 模拟信号编码为数字信号  
这种编码方式最典型的例子是常用于对音频信号进行编码的脉冲调制PCM。它主要包括三个步骤，即采样、量化和编码。  
采样定理：在通信领域，带宽是指信号最高频率和最低频率之差，单位为Hz。因此，将模拟信号转换成数字信号时，假设原始信号中的最大频率为*f*，那么采用频率*f*<sub>采样</sub>必须大于等于最大频率*f*的两倍，才能保证采样后的数字信号完整保留原始模拟信号的信息。采样定理又称奎斯特定理。  
+ 采样是指对模拟信号进行周期性扫描，把时间上连续的信号变成时间上离散的信号。根据采样定理，当采样的频率大于等于模拟数据的频带带宽（最高变化频率）的两倍时，所得的离散信号可以无失真地代表被采样的模拟数据。  
+ 量化是把采样取得的电平幅值按照一定的分级标准转化为对应的数字值并取整数，这样就把连续的电平幅值转换为了离散的数字量。采样和量化的实质就是分割和转换。  
+ 编码是把量化的结构转换为与之对应的二进制编码。  

#### 模拟信号调制为模拟信号  
为了实现传输的有效性，可能需要较高的频率。这种调制方式还可以使用频分复用FDM技术，充分利用带宽资源。电话机和本地局交换机采用模拟信号传输模拟数据的编码方式；模拟的声音数据是加载到模拟的载波信号中传输的。  

### 电路交换、报文交换和分组交换  
#### 电路交换  
在进行数据传输前，两个结点之间必须先建立一条专用（双方独占）的物理通信路径（由通信双方之间的交换设备和链路逐段连接而成），该路径可能经过许多中间结点。这一路径在整个数据传输期间一直被独占，直到通信结束后才被释放。因此，电路交换技术分为三个技术阶段：连接建立、数据传输和连接释放。  
从通信资源的分配角度来看，“交换”就是按照某种方式动态地分配传输线路的资源。电路交换的关键点是，在数据传输的过程中，用户始终占用端到端的固定传输带宽。  
电路交换技术的优点如下：  
+ 通信时延小。由于通信线路为通信双方用户专用，数据直达，因此传输数据的时延非常小。当传输的数据量较大时，这一优点非常明显。  
+ 有序传输。双方通信时按照发送顺序传送数据，不存在失序问题。  
+ 没有冲突。不同的通信双方拥有不同的信道，不会出现争用物理信道的问题。  
+ 适用范围广。电路交换既适用于传输模拟信号，有事用于传输数字信号。  
+ 实时性强。通信双方之间的物理通路一旦建立，双方就可以随时通信。  
+ 空间简单。电路交换的交换设备（交换机等）及控制均较简单。  

电路交换技术的缺点如下：  
+ 建立连接时间长。电路交换的平均连接建立时间对计算机通信来说太长。  
+ 线路独占，使用效率低。电路交换连接建立后，物理通路被通信双方独占，即使通信线路空闲，也不能供其他用户使用，因而信道利用率低。  
+ 灵活性差。只要在通信双方建立的通路中的任何一点出了故障，就必须重新拨号建立新的连接，这对十分紧急和重要的通信是很不利的。  
+ 难以格式化。电路交换时，数据直达，不同类型、不同规格、不同速率的终端很难相互通信，也难以在通信过程中进行差错控制。  

**电路建立后，除源结点和目的结点外，电路上的任何结点都采取“直通方式”接收数据和发送数据，即不会存在存储转发所耗费的时间。**  

#### 报文交换  
数据交换的单位是报文，报文携带由目标地址、源地址等信息。报文交换在交换结点采用的是存储转发的传输方式。  
报文交换技术的优点如下：  
+ 无需建立连接。报文交换不需要为通信双方预先建立一条专用的通信线路，不存在建立连接时延，用户可以随时发送报文。  
+ 动态分配线路。当发送方把报文交给交换设备时，交换设备先存储整个报文，然后选择一条合适的空闲线路，把报文发送出去。  
+ 提高线路可靠性。如果某条传输路径发生故障，那么可重新选择另一条路径传输数据，因此提高了传输的可靠性。  
+ 提高线路利用率。通信双方不是固定占用一条通信线路，而是在不同的时间一段一段地部分占用这条物理通道，因而大大提高了通信线路的利用率。  
+ 提供多目标服务。一个报文可以同时发送给多个目的地址，这在电路交换中是很难实现的。  

报文交换技术的缺点如下：  
+ 由于数据进入交换结点后要经历存储、转发这一过程，因此会引起转发时延（包括接收报文、校验正确性、排队、发送时间等）。  
+ 报文交换对报文的大小没有限制，这就要求网络结点需要有较大的缓存空间。  

报文交换主要使用在早期的电报通信网中，现在极少使用，通常被较先进的分组交换方式所取代。  

#### 分组交换  
同报文交换方式一样，分组交换也采用存储转发方式，但解决了报文交换中大报文传输的问题。分组交换限制了每次传输的数据块大小的上限，把大的数据块划分为合理的小数据块，再加上一些必要的控制信号（如源地址、目的地址和编号信息等），构成分组（Packet）。网络结点根据控制信息把分组送到下一结点，下一结点接收到分组后，暂时保存并排队等待传输，然后根据分组控制信息选择它的下一个结点，直到到达目的结点。  
分组交换的优点如下：  
+ 无建立延时。不需要为通信双方预先建立一条专用的通信线路，不存在连接建立时延，用户可随时发送分组。  
+ 线路利用率高。通信双方不是固定占有一条通信线路，而是在不同的时间一段一段地部分占用这条物理通路，因而大大提高了通信线路的利用率。  
+ 简化了存储管理（相对于报文交换）。因为分组的长度固定，相应的缓冲区的大小也固定，在交换结点中存储器的管理通常被简化为对缓冲区的管理，相对比较容易。  
+ 加速传输。分组是逐个传输的，可以使后一个分组的存储操作与前一个分组的转发操作并行，这种流水线方式减少了报文的传输时间。此外，传输一个分组所需的缓冲区比传输一次报文所需的缓冲区小很多，这样因缓冲区不足而等待发送的概率及时间也必然少得多。  
+ 减少了出错概率和重发数据量。因为分组较短，其出错概率必然减小，所处每次重发的数据量也就大大减少，这样不仅提高了可靠性，也减少了传输时延。  

分组交换的缺点如下：  
+ 存在传输时延。尽管分组交换比报文交换的传输时延少，但相对于电路交换仍存在存储转发时延，而且其结点交换机必须具有更强的处理能力。  
+ 需要传输额外的信息量。每个小数据块都要加上源地址、目的地址和分组编号等信息，从而构成分组，因此使得传送的信息量增大了5%~10%,一定程度上降低了通信效率，增加了处理的时间，使控制复杂，时延增加。  
+ 当分组交换采用数据报服务时，可能会出现失序、丢失或重复分组，分组到达目的结点时，要对分组按编号进行排序等工作，因此很麻烦。若采用虚电路服务，虽无失序问题，但有呼叫建立、数据传输和虚电路释放三个过程。

要传送的数据量很大且其传送时间远大于呼叫时间时，采用电路交换较为合适。端到端的通路由多段链路组成时，采用分组交换传送数据较为合适。从提高整个网络的信道利用率上看，报文交换和分组交换优于电路交换，其中分组交换比报文交换的时延小，尤其适合于计算机之间的突发式数据通信。  